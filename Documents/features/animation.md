# Feature: アニメーション機能 (Animation)

## 1. Overview
マルチタブ形式のドット絵エディタ「Eede」において、作成したドット絵のアニメーションを確認・構成するための機能です。描画データ（画像）と動きの定義（パターン）を分離し、異なる画像に対して同一の動きを即座に適用・プレビューできることを最大の特徴とします。

## 2. Data Model

### 2.1 AnimationPattern
アニメーションの最小単位となる定義。
- `Name`: パターン名（例: "待機", "走り"）
- `GridSettings`: グリッド情報（セルサイズ、オフセット、パディング）
- `Frames`: `AnimationFrame` のリスト

### 2.2 AnimationFrame
各フレームの詳細情報。
- `CellIndex`: スプライトシート上のセルインデックス
- `Duration`: 表示時間 (ms)

### 2.3 AnimationPatterns
アプリケーション全体で保持される、アニメーションパターンのコレクション（ファーストクラスコレクション）。

## 3. Logic & Behavior

### 3.1 リアルタイムプレビュー
- 現在フォーカスされているドックエリアの画像データと、選択中の `AnimationPattern` を組み合わせて再生します。
- タブ（画像）を切り替えても、選択中のパターンや再生位置（フレーム）は維持され、対象画像のみが即座に切り替わります。

### 3.2 アニメーション編集モード
- トグルボタンにより切り替わります。
- **動作**: メインキャンバスのクリック操作が「描画」から「クリックしたセルのシーケンスへの追加」に変更されます。
- **状態管理**: `AnimationEditingState` (State Pattern) がキャンバス操作をハンドリングします。

### 3.3 シーケンサー操作
- フレームのドラッグ＆ドロップによる並べ替え。
- 各フレームの Duration 編集。
- 特定フレームの削除、およびシーケンスのクリア。

### 3.4 インポート・エクスポート
- アニメーションパターンを JSON 形式で外部ファイルに出力、および読み込みが可能です。

## 4. Constraints
- **グリッド依存**: アニメーションは指定された `GridSettings` に基づいて画像を切り出します。画像サイズがグリッド設定に満たない場合は、プレビューが抑制されます。
- **グローバル共有**: パターンリストはアプリ全体で共有されるため、特定の画像ファイルに紐付いた保存（プロジェクトファイル形式）は現時点では未実装です。
- **書き出し制限**: プレビューとパターン情報の保存に特化しており、GIF/APNG 等の動画ファイルとしての書き出しは対象外です。