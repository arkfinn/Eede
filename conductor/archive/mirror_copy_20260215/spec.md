# 鏡面反転コピー機能 仕様書 (spec.md)

## 1. 概要
作業エリア全体、または選択範囲の半分を、もう半分に鏡面反転させてコピーする機能を追加する。
ドット絵のシンメトリーなデザイン作業を効率化することを目的とする。

## 2. 機能要件

### 2.1 鏡面反転コピーの種類
以下の2つのアクションを提供する。
- **MirrorCopyRight (左から右へ反転コピー)**: 領域の左半分を右半分に反転して上書きする。
- **MirrorCopyBottom (上から下へ反転コピー)**: 領域の上半分を下半分に反転して上書きする。

### 2.2 対象範囲
1. **選択範囲がある場合**: 選択範囲内の領域を対象に反転コピーを実行する。
2. **選択範囲がない場合**: キャンバス全体（作業エリア）を対象に反転コピーを実行する。

### 2.3 奇数サイズ時の挙動
対象範囲（幅または高さ）が奇数の場合、中心のピクセル列（または行）を **中心軸** とし、その軸自体は書き換えずに左右（または上下）を入れ替える。
- 例: 5px幅の場合、1〜2列目を反転させて4〜5列目にコピーする。3列目（中心）は維持される。

### 2.4 ユーザーインターフェース
- **配置場所**: `PictureActionMenu`（作業エリア右側のツールバー）に追加。
- **使用アイコン**:
    - `MirrorCopyRight.axaml`
    - `MirrorCopyBottom.axaml`
- **ツールチップ**:
    - MirrorCopyRight: 「左を右に鏡面コピー: 左半分を右半分に反転してコピーします」
    - MirrorCopyBottom: 「上を下に鏡面コピー: 上半分を下半分に反転してコピーします」

### 2.5 履歴管理
- 他の画像編集操作と同様に、実行後は Undo/Redo が可能であること。

## 3. 非機能要件
- 巨大な画像（4096px以上）に対しても、既存の画像処理エンジン（Eede.Domain）を使用して効率的に動作すること。

## 4. 受け入れ基準
- [ ] 選択範囲がない状態で MirrorCopyRight を実行し、キャンバスの左半分が右半分に正しく反転コピーされること。
- [ ] 選択範囲がある状態で MirrorCopyBottom を実行し、選択範囲の上半分が下半分に正しく反転コピーされること。
- [ ] 奇数サイズの領域で実行した際、中心軸のピクセルが維持されること。
- [ ] 操作後に Undo を実行すると、操作前の状態に戻ること。

## 5. 範囲外 (Out of Scope)
- 右から左、下から上への反転コピー機能（今回のフェーズでは実装しない）。
