# Specification: Codebase Refactoring and Structural Improvement

## Overview
プロジェクト全体のコード品質と保守性を向上させるため、巨大なクラス（目安500行以上）や設計上の問題があるクラスを調査し、適切な単位で分割・再構成します。特にPresentation層のViewModelを優先的に扱い、DDDおよびオニオンアーキテクチャの原則に基づいた構造改善を目指します。

## Functional Requirements
- **ターゲットの特定:** 全プロジェクトを対象に、500行を超える巨大クラス、および行数に関わらず設計上の問題（責任の混在、不適切な依存関係など）があるクラスをリストアップする。
- **優先順位付け:** Presentation層のクラスを最優先とし、リファクタリング対象を決定する。
- **構造改善:** `refactor-five-lines-strategy` や `refactor-ddd-onion-complete` スキルを活用し、単一責任原則（SRP）に従ってクラスを分割・整理する。
- **依存関係の整理:** Presentation層からドメインロジックを排除し、ドメインモデルを適切に構築。依存性逆転の原則（DIP）を適用して層間の結合度を下げる。

## Non-Functional Requirements
- **テスト駆動リファクタリング:** 変更前に既存挙動を保護するユニットテストを作成し、リファクタリング後もテストが通過することを保証する。
- **保守性の向上:** コードの可読性と再利用性を高め、将来の機能追加を容易にする。

## Acceptance Criteria
- ターゲットとした巨大クラスが適切なサイズに分割されていること。
- 設計上の問題が指摘されたクラスが、DDD/オニオンアーキテクチャの原則に沿って改善されていること。
- 修正・分割された各コンポーネントに対して、十分なユニットテストが提供されていること。
- Presentation層からビジネスロジックが排除され、適切な層（Domain/Application）に移動していること。
- プロジェクト全体のビルドが通り、既存の機能が正常に動作すること。

## Out of Scope
- 全く新しい機能の追加（リファクタリングに伴う構造的な変更に留める）。
