# 拡大縮小機能の追加 仕様書

## 概要
作業エリア（キャンバス全体）または選択範囲内の画像を数値指定で拡大縮小する機能を追加する。
ツールバーに専用のボタンを配置し、ダイアログを通じてピクセル単位またはパーセント単位での精密なスケーリングを可能にする。

## 機能要件
### 1. 拡大縮小ダイアログ
- **起動:** ツールバーの「拡大縮小」ボタン（四隅矢印アイコン）から起動。
- **入力項目:**
  - 幅・高さ（ピクセル単位 / パーセント単位の相互変換可能）。
  - アスペクト比固定チェックボックス（デフォルトON）。
  - クイック設定ボタン（0.5x, 2x, 3x, 4x 等）。
  - アンカー選択（9マスの位置指定、デフォルト左上）。
- **確定時の挙動:**
  - ダイアログのOKボタン押下で、対象（キャンバスまたは選択範囲）に対してスケーリングを適用する。

### 2. 対象別の挙動
- **範囲選択なし（キャンバス全体）:**
  - 拡大時：指定したアンカーに基づき、キャンバスサイズ自体を拡張して画像をリサイズする。
  - 縮小時：画像は縮小されるが、キャンバスサイズは既存のサイズを維持する（余白が生じる）。
- **範囲選択あり（選択範囲内）:**
  - 選択範囲内の画像を指定サイズにリサイズし、**「プレビュー状態」**に移行する。
  - プレビュー状態では、ドラッグによる手動拡大縮小と同様に、移動や再変形が可能。
  - 確定（Enter等）によってキャンバスに書き込まれる。

### 3. アルゴリズム
- ニアレストネイバー法（補間なし）を使用し、ドット絵の質感を維持する。

## 非機能要件
- **UI/UX:** モダンで直感的なダイアログデザイン。数値入力の即時バリデーション（負数入力不可など）。
- **Undo/Redo:** 拡大縮小操作を一回の履歴として記録。

## 承諾基準 (Acceptance Criteria)
- 範囲選択がない時に、アンカー（例：中央）を指定してキャンバスごと200%拡大できること。
- 範囲選択がある時に、ダイアログで50%に縮小し、その後プレビュー状態で位置を微調整して確定できること。
- アスペクト比固定が機能し、片方の値を変更した時にもう一方が自動追随すること。

## 対象外 (Out of Scope)
- ニアレストネイバー以外の補間アルゴリズム（バイリニア等）の実装。
- 拡大縮小時の回転機能。
