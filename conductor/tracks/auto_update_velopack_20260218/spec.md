# トラック仕様書：Velopackによる自動アップデート機能の導入

## 1. 概要
本トラックでは、Velopackを使用してEedeの自動アップデート機能を実装します。ユーザーが常に最新の機能と改善を享受できるよう、作業の手を止めることなくバックグラウンドで更新を行い、「ようこそ画面」やメニューを通じて自然な形で最新版への移行を促すUXを提供します。

## 2. 機能要件

### 2.1 アップデートの確認とダウンロード
- **自動確認:** アプリケーション起動時に、GitHub Releasesをソースとして最新バージョンの有無をバックグラウンドで確認する。
- **手動確認:** ヘルプメニューに「アップデートを確認」項目を追加し、ユーザーが任意のタイミングで確認できるようにする。
- **バックグラウンドダウンロード:** アップデートが見つかった場合、ユーザーの作業を妨げないようバックグラウンドでダウンロードを実行する。

### 2.2 UI/UX 統合
- **「ようこそ画面」への統合:**
    - アップデート確認中、ダウンロード中、適用準備完了などのステータスを表示する。
    - ダウンロード完了後は、「再起動して最新バージョンを適用」という目立つアクションボタンを表示する。
- **メインエディタ画面:**
    - ダウンロード完了時に、ステータスバーやメニュー付近に控えめなインジケーターを表示し、更新の準備が整ったことを知らせる。
- **更新の適用:**
    - ユーザーが「再起動」を選択した場合は即座にアプリを終了し、Velopackのプロセスにより更新を適用して再起動する。
    - ユーザーが手動でアプリを終了した場合も、次回の起動時には最新バージョンが適用されている状態にする。

### 2.3 インフラストラクチャ
- **GitHub Releases 連携:** GitHubのリポジトリをリリースソースとして設定し、Velopackが提供するリリース管理機能を利用する。

## 3. 非機能要件
- **ネットワーク耐性:** ネットワーク未接続時やダウンロード失敗時に、アプリケーションの動作を阻害しないこと。
- **低負荷:** バックグラウンドでのチェックおよびダウンロードが、描画パフォーマンスに影響を与えないように非同期で行うこと。
- **安全性:** 署名されたパッケージのみを適用し、安全なアップデートを保証すること（Velopackの標準機能に準拠）。

## 4. 受け入れ基準
- [ ] アプリ起動時にGitHub上の新バージョンが正しく検知されること。
- [ ] バックグラウンドでダウンロードが完了し、完了後にUIに通知が表示されること。
- [ ] 「ようこそ画面」のボタンから再起動して、バージョンが更新されること。
- [ ] 手動で終了・再起動した際も、ダウンロード済みの更新が適用されること。
- [ ] ヘルプメニューからの手動確認が機能すること。

## 5. アウトオブスコープ
- 自動アップデート自体の無効化設定（将来的な検討事項とする）。
- ベータ版/カナリア版などの複数チャンネルの切り替え機能。
